## 1 基本架构及业务流程

为了保证服务质量和数据的安全，我们提供了服务器架构设计和编码方面的建议，希望开发者能尽可能的参考如下架构进行开发：

### 1 基本架构

![](//mccdn.qcloud.com/static/img/7acb464a731cd8a47480566ab443e2d9/image.png)

主要包括三个部分：

1. 腾讯云-对象存储服务，提供高成功率、高可靠、高速的对象存储服务；
2. 开发者服务器提供至少如下3个功能：
   1. 生成签名。**签名的生成不能在终端APP上进行，否则会产生极大的安全隐患**；
   2. 使用数据库管理用户信息、文件资源信息；
   3. 响应终端的业务请求；
3. 开发者服务器还可以直接与腾讯云-对象存储进行对象管理操作。
4. 终端，通常既上传对象也下载对象。在展示图片前，通常先从开发者服务器获取对象信息，比如对象的url；在上传对象前，通常先从开发者服务器获取签名，然后带着签名请求腾讯云-对象存储。

### 2 业务流程：对象上传

上传对象前先请求开发者服务器获取上传签名，然后再请求腾讯云-对象存储，腾讯云-对象存储会对上传签名进行验证，无效的签名会返回签名认证错误等信息。

![](//mccdn.qcloud.com/static/img/7acb464a731cd8a47480566ab443e2d9/image.png)

**上传流程主要包括三个步骤：**

1. 访问开发者服务器，获取签名（注意：签名的创建不能在终端APP上进行，否则可能会导致用户信息泄露等安全隐患）；
2. 终端上传对象，腾讯云-对象存储验证权限、存储对象，生成文件ID，URL等信息返回给终端；
3. 终端将对象信息和用户信息反馈给开发者业务服务器。





